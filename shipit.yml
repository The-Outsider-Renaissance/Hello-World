dependencies:
  override: []

deploy:
  max_commits: # Automatically deploy all commits, no matter how many.
  override:
    - |
      pids=""

      bin/deployer bash -lc "id=wumpus bin/deploy" &
      pids="${pids} $!"

      bin/deployer bash -lc "id=boom bin/deploy" &
      pids="${pids} $!"

      bin/deployer bash -lc "id=bumpus bin/deploy" &
      pids="${pids} $!"

      errors=0
      for pid in ${pids}
      do
          wait "${pid}" || errors=1
      done

      exit "$errors"

tasks:
  restart:
    action: "Fake container task"
    description: "Pretend to run a task inside a tooling container"
    steps:
      - ./bin/deployer bash -lc "echo 'Pretending to run a task'"
